(this.webpackJsonpDrafter=this.webpackJsonpDrafter||[]).push([[0],{136:function(e,t,n){},390:function(e,t,n){"use strict";n.r(t);var r,c,a,s=n(1),o=n.n(s),i=n(29),d=n.n(i),j=(n(136),n(137),n(409)),u=n(401),l=n(130),b=n(6),O=n(414);!function(e){e.Bind="bind"}(r||(r={})),function(e){e[e.Save=0]="Save",e[e.Load=1]="Load",e[e.Export=2]="Export",e[e.Clear=3]="Clear",e[e.Debug=4]="Debug"}(c||(c={})),function(e){e.ParsingError="ParsingError",e.AssetNotFound="AssetNotFound",e.RemoteMethodNotFound="RemoteMethodNotFound",e.StageNotFound="StageNotFound",e.AccessPointNotFound="AccessPointNotFound",e.FileInputError="FileInputError"}(a||(a={}));var h=n(410),x=n(118),f=n(399),g=n(2),p=n(116),v=n.n(p),m=n(117),y=n(26),k=n(413),I=n(18),S=n.n(I),C=n(33),w=n(111),E=n(112),A=n(94),D=n(113),q=n.n(D),R=n(114),M=n(115),N=n.n(M);function K(e,t){return{kind:"Error",errorKind:e,message:t}}function T(e,t){var n=e.find((function(e){return e.stageId===t}));return n||K(a.StageNotFound,"Cannot find Stage with id ".concat(t))}function F(e){var t=e.name,n=e.requestType,r=e.responseType;return"".concat(t,"(").concat(n.name,"): ").concat(r.name)}function B(e,t){var n,r=t.remoteMethodId,c=Object(k.a)(),s=function(e,t){return e.methods.find((function(e){return e.remoteMethodId===t}))||K(a.RemoteMethodNotFound,"Cannot find Remote Method with id ".concat(t," in asset ").concat(e))}(e,r);if("RemoteMethod"===s.kind){var o={requester:{kind:"Requester",type:(n=s).requestType},responder:{kind:"Responder",type:n.responseType}},i=o.requester,d=o.responder,j=Object(R.truncate)("".concat(e.name,"-").concat(s.name),{length:25}),u=Math.max(6*j.length,50);return{kind:"Stage",name:j,methodName:s.name,requester:i,responder:d,stageId:c,assetId:e.assetId,volumes:Object(y.a)(),x:0,y:0,rx:u,ry:30}}return s}function L(e,t){return N()(e.type.fields,t.type.fields)}function J(e,t){var n=e.x,r=e.y;return{x:n,y:"Requester"===t?r+30:r-30}}function H(e){return P.apply(this,arguments)}function P(){return(P=Object(C.a)(S.a.mark((function e(t){var n,r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==(n=Object(y.a)((null===t||void 0===t?void 0:t.files)||void 0)).size){e.next=9;break}return r=n.first(),e.next=5,r.text();case 5:return c=e.sent,e.abrupt("return",c);case 9:return e.abrupt("return",K(a.FileInputError,"Didn't find exactly one protobuf file for the asset. Files were [".concat(n.map((function(e){return e.name})).join(", "),"]}")));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){return V.apply(this,arguments)}function V(){return(V=Object(C.a)(S.a.mark((function e(t){var n,r,c,a,s,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.assets,r=t.stages,c=t.edges,a=new q.a,s={version:"3",services:{"orchestrator-node":{image:"sipgisr/grpc-orchestrator:latest",volumes:[{type:"bind",source:"./config.yml",target:"/app/config/config.yml"}]}}},r.toList().forEach((function(e,t){var r=e.name,c=e.assetId,a=e.volumes,o=n.find((function(e){return e.assetId===c}));!(r in s.services)&&o&&(s.services[r.replaceAll(/\s+/g,"-")]={image:o.image,volumes:a.map((function(e){return{source:e.source,target:e.target,type:e.type}})).toArray(),ports:["".concat(8061+t,":8062")]})})),o={stages:r.map((function(e){var t=e.name;return{name:t,host:t.replaceAll(/\s+/g,"-"),port:8061}})).toArray(),links:c.map((function(e){var t=e.requesterId,n=e.responderId,c=T(r,t),a=T(r,n);if("Error"===c.kind)throw c;if("Error"===a.kind)throw a;return{source:{stage:c.name,field:c.methodName},target:{stage:a.name,field:a.methodName}}})).toArray()},a.file("docker-compose.yml",Object(A.a)(s)),a.file("config.yml",Object(A.a)(o)),e.abrupt("return",a.generateAsync({type:"blob"}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t){var n=e.find((function(e){return e.assetId===t}));return n||K(a.AssetNotFound,"Cannot find Asset with id ".concat(t))}function W(e){var t=e.errorKind,n=e.message;console.error("".concat(t,": ").concat(n))}var X={kind:"State",assets:Object(y.b)(),stages:Object(y.b)(),edges:Object(y.b)(),actions:Object(y.a)()};function Y(e,t){switch(t.type){case"CreateAsset":var n=function(e){try{var t=Object(w.parse)(e).root,n=t.nestedArray.filter((function(e){return e.toJSON().methods})).map((function(e){return e}));return Object(y.b)(n.flatMap((function(e){return e.methodsArray.map((function(e){return{kind:"RemoteMethod",name:e.name,requestType:Object(g.a)(Object(g.a)({},t.lookupType(e.requestType).toJSON()),{},{name:e.requestType,streamed:e.requestStream||!1}),responseType:Object(g.a)(Object(g.a)({},t.lookupType(e.responseType).toJSON()),{},{name:e.responseType,streamed:e.responseStream||!1}),remoteMethodId:Object(k.a)()}}))})))}catch(r){return K(a.ParsingError,r.message)}}(t.protobufCode);return"errorKind"in n?n:{assets:e.assets.add({kind:"Asset",assetId:Object(k.a)(),name:t.name,image:t.image,methods:n})};case"SetAssets":return Object(g.a)(Object(g.a)({},e),{},{assets:t.assets});case"UpdateAsset":var r=U(e.assets,t.asset.assetId);return"Error"===r.kind?r:{assets:e.assets.remove(r).add(t.asset)};case"DeleteAsset":var c=U(e.assets,t.asset.assetId);if("Error"===c.kind)return c;var s=e.assets.remove(c),o=e.stages.filter((function(e){var t=e.assetId;return c.assetId!==t})),i=e.edges.filter((function(e){var t=e.requesterId,n=e.responderId;return"Error"!==T(o,t).kind&&"Error"!==T(o,n).kind}));return{assets:s,stages:o,edges:i};case"AddStage":return{stages:e.stages.add(t.stage)};case"SetStages":return{stages:t.stages};case"DeleteStage":var d=T(e.stages,t.stage.stageId);return"Error"===d.kind?d:{stages:e.stages.remove(d),edges:e.edges.filter((function(e){var t=e.requesterId,n=e.responderId;return d.stageId!==t&&d.stageId!==n}))};case"UpdateStage":var j=T(e.stages,t.stage.stageId);return"Error"===j.kind?j:{stages:e.stages.remove(j).add(Object(g.a)(Object(g.a)({},j),t.stage))};case"AddVolume":var u=T(e.stages,t.stageId);if("Error"===u.kind)return u;var l=Object(g.a)(Object(g.a)({},u),{},{volumes:u.volumes.push(t.volume)});return{stages:e.stages.remove(u).add(l)};case"SetEdges":return{edges:t.edges};case"AddEdge":return{edges:e.edges.add(t.edge)};case"DeleteEdge":return{edges:e.edges.remove(t.edge)};case"RestoreState":return t.state;case"ClearState":return X}}var G=v()(Object(m.redux)((function(e,t){var n=Y(e,t);if("Error"!==n.kind)return n.actions?Object(g.a)(Object(g.a)({},e),n):Object(g.a)(Object(g.a)(Object(g.a)({},e),n),{},{actions:e.actions.push([new Date,t])});var r=n.errorKind,c=n.message;return console.error("Error ".concat(r," in ").concat(t.type,": ").concat(c)),e}),X));function Q(){return G((function(e){return e.dispatch}))}function Z(){return G((function(e){var t=e.dispatch;return function(e){return t({type:"UpdateStage",stage:e})}}))}function $(){return G((function(e){return[e.assets,function(t){return e.dispatch({type:"SetAssets",assets:t})}]}))}function _(){return G((function(e){return e.stages}))}function ee(){return G((function(e){return e.edges}))}var te=n(0);function ne(e){var t=e.show,n=e.close,r=Q();return Object(te.jsxs)(h.a,{show:t,onEscapeKeyDown:n,children:[Object(te.jsxs)(h.a.Header,{children:[Object(te.jsx)(h.a.Title,{children:"Really clear the editor?"}),Object(te.jsx)(x.a,{onClick:n})]}),Object(te.jsxs)(h.a.Body,{children:[Object(te.jsx)(f.a,{variant:"primary",onClick:n,children:"Cancel"}),"\xa0",Object(te.jsx)(f.a,{variant:"danger",onClick:function(){r({type:"ClearState"}),n()},children:"Clear"})]})]})}var re=n(411),ce=n(412),ae=n(400),se=n(17);function oe(e){var t=e.content,n=e.language;return Object(te.jsxs)("div",{style:{position:"relative"},children:[Object(te.jsx)(ce.a,{language:n,style:ae.a,customStyle:{padding:"".concat(10,"px"),borderRadius:"".concat(5,"px")},children:t}),Object(te.jsx)(f.a,{variant:"outline-secondary",size:"sm",style:{position:"absolute",right:"".concat(5,"px"),top:"".concat(5,"px")},onClick:function(){return navigator.clipboard.writeText(t)},children:Object(te.jsx)(se.b,{size:15})})]})}function ie(e){var t=e.show,n=e.close,r=G();return Object(te.jsxs)(h.a,{show:t,onEscapeKeyDown:n,children:[Object(te.jsxs)(h.a.Header,{children:[Object(te.jsx)(h.a.Title,{children:"Debug Info"}),Object(te.jsx)(x.a,{onClick:n})]}),Object(te.jsxs)(h.a.Body,{children:[Object(te.jsx)("h5",{children:"Edit History"}),Object(te.jsx)(re.a,{children:r.actions.reverse().map((function(e,t){var n=Object(b.a)(e,2),r=n[0],c=n[1];return Object(te.jsxs)(re.a.Item,{eventKey:t.toString(),children:[Object(te.jsxs)(re.a.Header,{children:[Object(te.jsx)("span",{style:{textAlign:"left",width:"40%",display:"inline-block"},children:c.type}),Object(te.jsx)("em",{style:{textAlign:"right",width:"50%",display:"inline-block"},children:r.toLocaleString()})]}),Object(te.jsx)(re.a.Body,{children:Object(te.jsx)(oe,{content:JSON.stringify(c,null,2),language:"json"})})]},t)}))}),Object(te.jsx)("br",{}),Object(te.jsx)("h5",{children:"Application State"}),Object(te.jsx)(re.a,{children:Object(te.jsxs)(re.a.Item,{eventKey:"state",children:[Object(te.jsx)(re.a.Header,{children:"State"}),Object(te.jsx)(re.a.Body,{children:Object(te.jsx)(oe,{content:JSON.stringify(r,null,2),language:"json"})})]})})]})]})}var de=n(408),je=n(124);function ue(e){var t=e.show,n=e.close,r=G(),c=Object(s.useState)("solution.zip"),a=Object(b.a)(c,2),o=a[0],i=a[1],d=function(){var e=Object(C.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(r);case 2:t=e.sent,saveAs(t,o);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(te.jsxs)(h.a,{show:t,onEscapeKeyDown:n,children:[Object(te.jsxs)(h.a.Header,{children:[Object(te.jsx)(h.a.Title,{children:"Export Solution"}),Object(te.jsx)(x.a,{onClick:n})]}),Object(te.jsxs)(h.a.Body,{children:[Object(te.jsx)(de.a.Label,{children:"Filename"}),Object(te.jsx)(de.a.Control,{placeholder:"solution.zip",value:o,onChange:function(e){return i(e.target.value)}}),Object(te.jsx)("br",{}),Object(te.jsx)(je.a,{controlId:"floatingSelect",label:"Export to",children:Object(te.jsx)(de.a.Select,{children:Object(te.jsx)("option",{children:"Docker Compose"})})}),Object(te.jsx)("br",{}),Object(te.jsx)(f.a,{onClick:function(){d(),n()},children:"Export"})]})]})}function le(e){var t=e.show,n=e.close,r=G((function(e){var t=e.dispatch;return function(e){return t({type:"RestoreState",state:e})}})),c=Object(s.useRef)(null);return Object(te.jsxs)(h.a,{show:t,onEscapeKeyDown:n,children:[Object(te.jsxs)(h.a.Header,{children:[Object(te.jsx)(h.a.Title,{children:"Load a solution from a File"}),Object(te.jsx)(x.a,{onClick:n})]}),Object(te.jsxs)(h.a.Body,{children:[Object(te.jsx)(de.a.Label,{children:"Solution file"}),Object(te.jsx)(de.a.Control,{type:"file",ref:c,accept:".json"}),Object(te.jsx)("br",{}),Object(te.jsx)(f.a,{onClick:Object(C.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(c.current);case 2:"string"===typeof(t=e.sent)&&r((a=t,JSON.parse(a,(function(e,t){return"accessPoints"===e||"actions"===e||"volumes"===e?Object(y.a)(t):"methods"===e||"assets"===e||"stages"===e||"edges"===e?Object(y.b)(t):t})))),n();case 5:case"end":return e.stop()}var a}),e)}))),children:"Load"})]})]})}var be=n(125);function Oe(e){var t=e.show,n=e.close,r=Object(s.useState)("solution.json"),c=Object(b.a)(r,2),a=c[0],o=c[1],i=G();return Object(te.jsxs)(h.a,{show:t,onEscapeKeyDown:n,children:[Object(te.jsxs)(h.a.Header,{children:[Object(te.jsx)(h.a.Title,{children:"Save Solution"}),Object(te.jsx)(x.a,{onClick:n})]}),Object(te.jsxs)(h.a.Body,{children:[Object(te.jsx)(de.a.Label,{children:"Filename"}),Object(te.jsx)(de.a.Control,{placeholder:"solution.json",value:a,onChange:function(e){return o(e.target.value)}}),Object(te.jsx)("br",{}),Object(te.jsx)(f.a,{onClick:function(){var e=function(e){return JSON.stringify(e)}(i);Object(be.saveAs)(new Blob([e]),a),n()},children:"Save"})]})]})}function he(){var e=Object(s.useState)(null),t=Object(b.a)(e,2),n=t[0],r=t[1],a=function(){return r(null)};return Object(te.jsxs)(u.a,{children:[Object(te.jsxs)(O.a,{horizontal:!0,children:[Object(te.jsx)(O.a.Item,{action:!0,onClick:function(){return r(c.Save)},children:"Save"}),Object(te.jsx)(O.a.Item,{action:!0,onClick:function(){return r(c.Load)},children:"Load"}),Object(te.jsx)(O.a.Item,{action:!0,onClick:function(){return r(c.Clear)},children:"Clear"}),Object(te.jsx)(O.a.Item,{action:!0,onClick:function(){return r(c.Export)},children:"Export"}),Object(te.jsx)(O.a.Item,{action:!0,style:{whiteSpace:"nowrap"},onClick:function(){return r(c.Debug)},children:"Debug Info"})]}),Object(te.jsx)(Oe,{show:n===c.Save,close:a}),Object(te.jsx)(le,{show:n===c.Load,close:a}),Object(te.jsx)(ne,{show:n===c.Clear,close:a}),Object(te.jsx)(ue,{show:n===c.Export,close:a}),Object(te.jsx)(ie,{show:n===c.Debug,close:a})]})}var xe=n(95);function fe(){return Object(te.jsx)(j.a,{children:Object(te.jsx)(u.a,{children:Object(te.jsxs)(l.a,{children:[Object(te.jsx)(j.a.Brand,{href:"/",children:xe.a}),Object(te.jsxs)(j.a.Text,{children:["v",xe.b]}),Object(te.jsx)(he,{})]})})})}var ge,pe=n(402),ve=n(123),me=n(403),ye=n(404);function ke(e){var t=e.value,n=e.setValue,r=Object(s.useState)(ge.Display),c=Object(b.a)(r,2),a=c[0],o=c[1],i=Object(s.useState)(t),d=Object(b.a)(i,2),j=d[0],u=d[1];return a===ge.Display?Object(te.jsx)("span",{onClick:function(){return o(ge.Edit)},children:t}):Object(te.jsxs)(pe.a,{children:[Object(te.jsx)(ve.a,{children:Object(te.jsx)(de.a.Control,{value:j,onChange:function(e){var t=e.target.value;return u(t)}})}),Object(te.jsx)(ve.a,{children:Object(te.jsx)(f.a,{onClick:function(){n(j),o(ge.Display)},children:Object(te.jsx)(se.a,{})})})]})}function Ie(e){var t=e.stage,n=e.selectStageId,c=Z(),a=Object(s.useState)(""),o=Object(b.a)(a,2),i=o[0],d=o[1],j=Object(s.useState)(""),u=Object(b.a)(j,2),l=u[0],O=u[1],h=Object(s.useState)(r.Bind),x=Object(b.a)(h,1)[0];return Object(te.jsxs)("tr",{children:[Object(te.jsx)("td",{children:Object(te.jsx)(de.a.Control,{value:i,onChange:function(e){var t=e.target.value;return d(t)},placeholder:"path/on/source"})}),Object(te.jsx)("td",{children:Object(te.jsx)(de.a.Control,{value:l,onChange:function(e){var t=e.target.value;return O(t)},placeholder:"path/on/target"})}),Object(te.jsx)("td",{children:Object(te.jsx)(de.a.Control,{value:x,disabled:!0})}),Object(te.jsx)("td",{children:Object(te.jsx)(f.a,{variant:"primary",onClick:function(){var e=Object(g.a)(Object(g.a)({},t),{},{volumes:t.volumes.push({volumeId:Object(k.a)(),source:i,target:l,type:x})});c(e),n(e.stageId),d(""),O("")},children:Object(te.jsx)(se.d,{})})})]})}function Se(e){var t=e.stageId,n=e.selectStageId,r=e.close,c=_(),a=Z(),s=c.find((function(e){return e.stageId===t}));if(!s)return null;return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsxs)(h.a.Header,{children:[Object(te.jsx)(h.a.Title,{children:s.name||"No stage selected"}),Object(te.jsx)(x.a,{onClick:r})]}),Object(te.jsxs)(h.a.Body,{children:[Object(te.jsx)("h5",{children:"Mounted Volumes"}),Object(te.jsxs)(me.a,{children:[Object(te.jsx)("thead",{children:Object(te.jsxs)("tr",{children:[Object(te.jsx)("th",{children:"Source"}),Object(te.jsx)("th",{children:"Target"}),Object(te.jsx)("th",{children:"Type"}),Object(te.jsx)("th",{children:"Action"})]})}),Object(te.jsxs)("tbody",{children:[null===s||void 0===s?void 0:s.volumes.map((function(e){var t=e.source,n=e.target,r=e.type,c=e.volumeId;return Object(te.jsxs)("tr",{children:[Object(te.jsx)("td",{children:t}),Object(te.jsx)("td",{children:n}),Object(te.jsx)("td",{children:r}),Object(te.jsx)("td",{children:Object(te.jsx)(f.a,{variant:"danger",onClick:function(){return function(e){var t=s.volumes.findIndex((function(t){return t.volumeId===e}));if(-1!==t){var n=Object(g.a)(Object(g.a)({},s),{},{volumes:s.volumes.remove(t)});a(n)}else console.error("attempt to delete volume that does not exist")}(c)},children:Object(te.jsx)(se.e,{})})})]},c)||"No stage selected"})),t&&Object(te.jsx)(Ie,{stage:s,selectStageId:n})]})]})]})]})}!function(e){e[e.Edit=0]="Edit",e[e.Display=1]="Display"}(ge||(ge={}));var Ce="0";function we(){var e=Object(s.useState)(Ce),t=Object(b.a)(e,2),n=t[0],r=t[1],c=$(),a=Object(b.a)(c,1)[0],o=G((function(e){var t=e.dispatch;return function(e){return t({type:"AddStage",stage:e})}}));Object(s.useEffect)((function(){r(Ce)}),[a]);var i=Object(s.useMemo)((function(){if(n!==Ce){var e=U(a,n.assetId);return"Asset"===e.kind?e:(W(e),null)}return null}),[n]);return Object(te.jsxs)("tr",{children:[Object(te.jsx)("td",{colSpan:n!==Ce?1:2,children:Object(te.jsx)(je.a,{controlId:"floatingSelectGrid",label:"Add asset",defaultValue:Ce,children:Object(te.jsxs)(de.a.Select,{"aria-label":"Add another asset",onChange:function(e){var t=e.target.value;r(t!==Ce?{assetId:t,remoteMethodId:Ce}:Ce)},children:[Object(te.jsx)("option",{value:Ce,children:"Select Asset to add"}),a.map((function(e){var t=e.assetId,n=e.name;return Object(te.jsx)("option",{value:t,children:n},t)}))]})})}),n!==Ce?Object(te.jsx)("td",{children:Object(te.jsx)(je.a,{controlId:"floatingSelectGrid",label:"Select method",children:Object(te.jsxs)(de.a.Select,{"aria-label":"Select method",onChange:function(e){var t=e.target.value;r(Object(g.a)(Object(g.a)({},n),{},{remoteMethodId:t}))},children:[Object(te.jsx)("option",{value:Ce,children:"Select method from asset"}),i.methods.map((function(e){var t=e.name,n=e.remoteMethodId;return Object(te.jsx)("option",{value:n,children:t},n)}))]})})}):null,Object(te.jsx)("td",{children:Object(te.jsx)(f.a,{disabled:n===Ce||n.remoteMethodId===Ce,variant:"primary",onClick:function(){if(n!==Ce&&n.remoteMethodId!==Ce&&i){var e=B(i,n);"Stage"===e.kind&&o(e)}},children:Object(te.jsx)(se.d,{})})})]})}function Ee(){var e=$(),t=Object(b.a)(e,1)[0],n=_(),r=Z(),c=Q(),a=Object(s.useState)(null),o=Object(b.a)(a,2),i=o[0],d=o[1],j=function(){return d(null)};return Object(te.jsxs)(pe.a,{children:[Object(te.jsx)("h6",{children:"Stages"}),Object(te.jsxs)(me.a,{children:[Object(te.jsx)("thead",{children:Object(te.jsxs)("tr",{children:[Object(te.jsx)("th",{children:"Name"}),Object(te.jsx)("th",{children:"Asset"}),Object(te.jsx)("th",{children:"Action"})]})}),Object(te.jsxs)("tbody",{children:[n.toList().map((function(e){var n;return Object(te.jsxs)("tr",{children:[Object(te.jsx)("td",{children:Object(te.jsx)(ke,{value:e.name,setValue:function(t){return r(Object(g.a)(Object(g.a)({},e),{},{name:t}))}})}),Object(te.jsx)("td",{children:(null===(n=t.find((function(t){var n=t.assetId;return e.assetId===n})))||void 0===n?void 0:n.name)||"No asset found"}),Object(te.jsx)("td",{children:Object(te.jsxs)(ye.a,{children:[Object(te.jsx)(f.a,{variant:"primary",onClick:function(){return d(e.stageId)},children:Object(te.jsx)(se.c,{})}),Object(te.jsx)(f.a,{variant:"danger",onClick:function(){return c({type:"DeleteStage",stage:e})},children:Object(te.jsx)(se.e,{})})]})})]},e.stageId)})),Object(te.jsx)(we,{})]})]}),Object(te.jsx)(h.a,{show:null!==i,onEscapeKeyDown:j,children:null!==i?Object(te.jsx)(Se,{stageId:i,selectStageId:d,close:j}):"No stage selected"})]})}var Ae=n(97),De=n(405),qe=n(406),Re=n(407);function Me(e){var t=e.origin,n=e.destination;return Object(te.jsx)("line",{x1:t.x,y1:t.y,x2:n.x,y2:n.y,stroke:"#999",strokeOpacity:"0.6",strokeWidth:"10"})}function Ne(e){var t,n=e.accessPoint,r=e.location,c=(t=n.type.fields,"#".concat(Object(E.MD5)(t).slice(0,6))),a=r.x,s=r.y;return Object(te.jsxs)(te.Fragment,{children:[n.type.streamed?Object(te.jsx)(te.Fragment,{children:[1,2].map((function(e){return Object(te.jsx)("circle",{r:12,cx:a-6*e/2,cy:s-6*e/2,stroke:"black",strokeWidth:"1px",fillOpacity:"0"},e)}))}):null,Object(te.jsx)("circle",{r:12,cx:a,cy:s,fill:"Requester"===n.kind?c:"white",stroke:"black",strokeWidth:"1px"}),Object(te.jsx)("circle",{r:6,cx:a,cy:s,fill:"Responder"===n.kind?c:"white",stroke:"black"})]})}function Ke(e){var t=e.stage,n=e.drag,r=e.setDrag,c=e.restartSimulation,a=t.name,s=t.x,o=t.y,i=t.rx,d=t.ry,j=_(),u=ee(),l=Q();return Object(te.jsxs)("g",{children:[Object(te.jsx)("ellipse",{rx:i,ry:d,cx:s,cy:o,fill:"#e8e8e8",fillOpacity:"0.5",stroke:"#000",strokeWidth:"1px",cursor:n?"grabbing":"grab",onMouseDown:function(e){var n=e.clientX,a=e.clientY;r({offset:{x:s-n,y:o-a},cursor:{x:n,y:a},stage:t,dragKind:"Stage"}),c()}}),Object(te.jsx)("text",{pointerEvents:"none",textAnchor:"middle",stroke:"#fff",strokeWidth:"0.5",strokeOpacity:"0.6",fill:"#000",fontSize:"16px",x:s,y:o,children:a}),[t.requester,t.responder].map((function(e){if("Empty"===e.type.name)return null;var c=J(t,e.kind);return Object(te.jsx)("g",{onMouseDown:function(n){var a=n.clientX,s=n.clientY,o=u.find((function(n){var r=n.requesterId,c=n.responderId;return"Requester"===e.kind?r===t.stageId:c===t.stageId}));if(o){l({type:"DeleteEdge",edge:o});var i=T(j,"Requester"===e.kind?o.responderId:o.requesterId);if("Error"===i.kind)throw i;r({offset:{x:c.x-a,y:c.y-s},cursor:{x:a,y:s},stage:i,dragKind:"Requester"===e.kind?"Responder":"Requester"})}else r({offset:{x:c.x-a,y:c.y-s},cursor:{x:a,y:s},stage:t,dragKind:e.kind})},onMouseUp:function(){n&&("Requester"===e.kind&&"Responder"===n.dragKind&&L(e,n.stage.responder)?l({type:"AddEdge",edge:{edgeId:Object(k.a)(),requesterId:t.stageId,responderId:n.stage.stageId}}):"Responder"===e.kind&&"Requester"===n.dragKind&&L(n.stage.requester,e)&&l({type:"AddEdge",edge:{edgeId:Object(k.a)(),requesterId:n.stage.stageId,responderId:t.stageId}}))},children:Object(te.jsx)(Ne,{location:c,accessPoint:e})},e.kind)}))]})}function Te(){var e=Object(s.useState)(Object(Ae.a)().stop()),t=Object(b.a)(e,1)[0],n=Object(s.useState)(null),r=Object(b.a)(n,2),c=r[0],a=r[1],o=_(),i=ee(),d=Object(s.useReducer)((function(e){return e+1}),0),j=Object(b.a)(d,2)[1];Object(s.useEffect)((function(){t.nodes(o.valueSeq().toArray()),t.force("vertical-center",Object(De.a)(300).strength(.01)).force("horizontal-center",Object(qe.a)(400).strength(.01)).force("charge",Object(Re.a)().strength(-100)),t.alpha(.5),t.alphaTarget(0).restart()}),[o,i]),t.on("tick",(function(){j()}));var u=function(){t.alpha(.5).restart()};return Object(s.useEffect)((function(){if(c){var e=c.cursor,t=c.offset,n=c.stage;"Stage"===c.dragKind&&(n.fx=e.x+t.x,n.fy=e.y+t.y)}}),[c]),Object(te.jsxs)("svg",{width:600,height:800,style:{border:"1px solid black"},viewBox:"0 0 ".concat(600," ").concat(800),onMouseMove:function(e){var t=e.clientX,n=e.clientY;c&&a(Object(g.a)(Object(g.a)({},c),{},{cursor:{x:t,y:n}}))},onMouseUp:function(){if(c){if("Stage"===c.dragKind){var e=c.stage;e.fx=e.fy=null,u()}a(null)}},onMouseLeave:function(){if(c){if("Stage"===c.dragKind){var e=c.stage;e.fx=e.fy=null,u()}a(null)}},children:[i.map((function(e){var t=e.requesterId,n=e.responderId,r=T(o,t),c=T(o,n);return"Error"!==r.kind&&"Error"!==c.kind?Object(te.jsx)(Me,{origin:J(r,"Requester"),destination:J(c,"Responder")},"edge-".concat(r.stageId,"-").concat(c.stageId)):null})),function(){if(c&&"Stage"!==c.dragKind){var e=c.offset,t=c.cursor,n=J(c.stage,c.dragKind);return Object(te.jsx)(Me,{origin:n,destination:{x:t.x+e.x,y:t.y+e.y}})}}(),o.valueSeq().map((function(e){return Object(te.jsx)(Ke,{stage:e,drag:c,setDrag:a,restartSimulation:u},e.stageId)}))]})}function Fe(){return Object(te.jsx)(te.Fragment,{children:Object(te.jsxs)(pe.a,{children:[Object(te.jsx)(ve.a,{children:Object(te.jsx)(Ee,{})}),Object(te.jsx)(ve.a,{children:Object(te.jsx)(Te,{})})]})})}function Be(){var e=G((function(e){var t=e.dispatch;return function(e){var n=e.name,r=e.image,c=e.protobufCode;return t({type:"CreateAsset",name:n,image:r,protobufCode:c})}})),t=Object(s.useState)(""),n=Object(b.a)(t,2),r=n[0],c=n[1],a=Object(s.useState)(""),o=Object(b.a)(a,2),i=o[0],d=o[1],j=Object(s.useRef)(null);return Object(te.jsxs)("tr",{children:[Object(te.jsx)("td",{children:Object(te.jsx)(de.a.Control,{placeholder:"Asset name",value:r,onChange:function(e){var t=e.target.value;return c(t)}})}),Object(te.jsx)("td",{children:Object(te.jsx)(de.a.Control,{placeholder:"<dockerid>/reponame",value:i,onChange:function(e){var t=e.target.value;return d(t)}})}),Object(te.jsx)("td",{children:Object(te.jsx)(de.a.Control,{type:"file",ref:j,accept:".proto"})}),Object(te.jsx)("td",{children:Object(te.jsx)(f.a,{variant:"primary",onClick:Object(C.a)(S.a.mark((function t(){var n,a;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=j.current)){t.next=9;break}return t.next=4,H(n);case 4:"string"===typeof(a=t.sent)?e({name:r,image:i,protobufCode:a}):W(a),c(""),d(""),n.value="";case 9:case"end":return t.stop()}}),t)}))),children:Object(te.jsx)(se.d,{})})})]})}function Le(){var e=Q(),t=$(),n=Object(b.a)(t,1)[0],r=G((function(e){var t=e.dispatch;return function(e){return t({type:"UpdateAsset",asset:e})}}));return Object(te.jsxs)(me.a,{children:[Object(te.jsx)("thead",{children:Object(te.jsxs)("tr",{children:[Object(te.jsx)("th",{children:"Asset Name"}),Object(te.jsx)("th",{children:"Image"}),Object(te.jsx)("th",{children:"Protobuf Interface"}),Object(te.jsx)("th",{children:"Action"})]})}),Object(te.jsxs)("tbody",{children:[n.map((function(t){return Object(te.jsxs)("tr",{children:[Object(te.jsx)("td",{children:Object(te.jsx)(ke,{value:t.name,setValue:function(e){return r(Object(g.a)(Object(g.a)({},t),{},{name:e}))}})}),Object(te.jsx)("td",{children:Object(te.jsx)(ke,{value:t.image,setValue:function(e){return r(Object(g.a)(Object(g.a)({},t),{},{image:e}))}})}),Object(te.jsx)("td",{children:t.methods.map((function(e){return Object(te.jsx)("pre",{children:F(e)},e.remoteMethodId)}))}),Object(te.jsx)("td",{children:Object(te.jsx)(f.a,{variant:"danger",onClick:function(){return e({type:"DeleteAsset",asset:t})},children:Object(te.jsx)(se.e,{})})})]},t.assetId)})),Object(te.jsx)(Be,{})]})]})}var Je=n(129),He=n(415),Pe=n(416);var ze=function(){return Object(te.jsxs)(Je.a,{basename:"/drafter",children:[Object(te.jsx)(fe,{}),Object(te.jsxs)(u.a,{children:[Object(te.jsx)(pe.a,{children:Object(te.jsx)("hr",{})}),Object(te.jsx)(pe.a,{children:Object(te.jsxs)(He.a,{defaultValue:"assets",children:[Object(te.jsx)(Pe.a,{eventKey:"assets",title:"Assets",children:Object(te.jsx)(Le,{})}),Object(te.jsx)(Pe.a,{style:{padding:15},eventKey:"editor",title:"Editor",children:Object(te.jsx)(Fe,{})})]})})]})]})};d.a.render(Object(te.jsx)(o.a.StrictMode,{children:Object(te.jsx)(ze,{})}),document.getElementById("root"))},95:function(e){e.exports=JSON.parse('{"a":"Drafter","b":"0.3.0"}')}},[[390,1,2]]]);
//# sourceMappingURL=main.67ff025c.chunk.js.map